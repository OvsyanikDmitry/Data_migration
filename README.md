# План проекта.
#### 1. Необходимо произвести миграцию данных в новую модель, затем собрать витрину данных shipping_datamart.
#### 2. Данные лежат в файле shipping.csv + DDL shipping. Таблицы должны располагаться в схеме public.
#### 3. На основе данных таблицы public.shipping, создать такие таблицы:
  - справочник стоимости доставки в страны public.shipping_country_rates;
  - справочник тарифов доставки вендора public.shipping_agreement;
  - справочник о типах доставки public.shipping_transfer;
  - создать таблицу public.shipping_info и связать ее с предыдущими справочниками;
  - создать таблицу статусов о доставке public.shipping_status;
#### 4.создать представление в виде витрины данных shipping_datamart.

# Требования к новой модели (включая SLA)
1.  Таблицы модели не должны иметь избыточность.
2.  Из новой модели можно получить те же результаты запрашиваемых данных, что и из старой модели.
3.  Каждая сущность имеет свои атрибуты в рамках одной таблицы.
4.  Новая схема должна поддерживать возможность добавления новых акций и промопредложений.
5.  Из новой модели можно получить те же результаты запрашиваемых данных, что и из старой модели с временем отличающимся не более чем на 1 порядок (x10)
6.  Доступность (99,99) и надежность должны быть не хуже, чем при старой схеме.

**Ход решения.**
1.  Создаем по DDL таблицу public.shipping и импортируем туда данные.
2.  Изучаем качество данных(Data quality), в нашем случае данные из некоторых сущностей избыточны и нам необходимо их декомпозировать. Для этого расположим данные в справочниках.
3.  На основе типов данных, которые есть в DDL public.shipping составим новую модель данных.
4.  По каждому условию наполнения таблиц, составим запросы. После успешных тестов запросов необходимо произвести миграцию данных в новые таблицы.
5.  Изучим новые таблицы, как отработали запросы и все ли данные перенеслись корректно.
6.  Составляем итоговую витрину данных public.shipping_datamart.  
7.  Создаем представление в виде итоговой витрины.

## Навигация.
- Скрипт создания таблиц в новой модели данных лежит в файле **DDL_NEW_MODEL_SHIPPING.SQL**;
- Скрипт миграции в новую модель данных лежит в файле **MIGRATION_IN_NEW_MODEL.SQL**;
- Скрипт создания представления в виде итоговой витрины данных лежит в файле **SHIPPING_DATAMART_VIEW.SQL**;
- Скрипт DDL public.shipping в файле **0_create_shipping.SQL**


## Описание сущностей итоговой витрины:
- **shippingid** — уникальный идентификатор доставки.
- **vendorid** — уникальный идентификатор вендора.
- **ransfer_type** — тип доставки из таблицы shipping_transfer
- **full_day_at_shipping** — количество полных дней, в течение которых длилась доставка
- **is_delay** — статус, показывающий просрочена ли доставка.
- **is_shipping_finish** — статус, показывающий, что доставка завершена.
- **delay_day_at_shipping** — количество дней, на которые была просрочена доставка.
- **payment_amount** — сумма платежа пользователя.
- **vat** — итоговый налог на доставку.
- **profit** — итоговый доход компании с доставки.
